asyncapi: 3.0.0
info:
  title: Product Service
  version: 1.0.0
defaultContentType: application/json
channels:
  product:
    address: 'product'
    description: The topic on which products may be produced and consumed.
    messages:
      ProductCreated:
        $ref: '#/components/messages/ProductCreated'
      ProductUpdated:
        $ref: '#/components/messages/ProductUpdated'
      ProductDeleted:
        $ref: '#/components/messages/ProductDeleted'
operations:
  createdProduct:
    action: send
    channel:
      $ref: '#/channels/product'
    messages:
      - $ref: '#/channels/product/messages/ProductCreated'
  updatedProduct:
    action: send
    channel:
      $ref: '#/channels/product'
    messages:
      - $ref: '#/channels/product/messages/ProductUpdated'
  deletedProduct:
    action: send
    channel:
      $ref: '#/channels/product'
    messages:
      - $ref: '#/channels/product/messages/ProductDeleted'
components:
  messages:
    ProductCreated:
      name: ProductCreated
      contentType: application/json
      payload:
        type: object
        $ref: '../common/schemas.yaml#/components/schemas/Product'
      headers:
        type: object
        properties:
          source:
            description: Name of the service which emits the event
            type: string
            const: "product"
          timestamp:
            description: UNIX Timestamp 
            type: number
            format: unix
          type:
            description: Type of the event
            type: string
            const: "created"
    ProductUpdated:
      name: ProductUpdated
      contentType: application/json
      payload:
        type: object
        $ref: '../common/schemas.yaml#/components/schemas/Product'
      headers:
        type: object
        properties:
          source:
            description: Name of the service which emits the event
            type: string
            const: "product"
          timestamp:
            description: UNIX Timestamp 
            type: number
            format: unix
          type:
            description: Type of the event
            type: string
            const: "updated"
    ProductDeleted:
      name: ProductDeleted
      contentType: application/json
      payload:
        type: object
        $ref: '../common/schemas.yaml#/components/schemas/Product'
      headers:
        type: object
        properties:
          source:
            description: Name of the service which emits the event
            type: string
            const: "product"
          timestamp:
            description: UNIX Timestamp 
            type: number
            format: unix
          type:
            description: Type of the event
            type: string
            const: "deleted"
